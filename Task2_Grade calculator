package Java;
import java.util.*;

public class Student {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.println("=======================================");
        System.out.println("   ğŸ« WELCOME TO SMART REPORT SYSTEM ğŸ«");
        System.out.println("=======================================");

        // Store student data
        Map<String, Double> studentPercentages = new HashMap<>();
        Map<String, String> overallGrades = new HashMap<>();

        boolean addMoreStudents = true;

        // Fixed subjects
        String[] subjectNames = {"Math", "Science", "English", "History", "Computer"};

        while (addMoreStudents) {
            System.out.print("\nEnter Student Name: ");
            String studentName = scanner.nextLine(); // allow full names with spaces

            System.out.print("Enter Roll Number: ");
            String rollNumber = scanner.nextLine();

            int totalMarks = 0;
            StringBuilder subjectDetails = new StringBuilder();

            subjectDetails.append("\n----------------------------------\n");
            subjectDetails.append("ğŸ“š Subject-wise Performance\n");
            subjectDetails.append("----------------------------------\n");
            subjectDetails.append(String.format("%-15s %-10s %-10s\n", "Subject", "Marks", "Grade"));
            subjectDetails.append("----------------------------------\n");

            // Enter marks for each fixed subject
            for (String subject : subjectNames) {
                int marks;
                while (true) {
                    System.out.print("Enter marks for " + subject + " (0â€“100): ");
                    marks = scanner.nextInt();
                    scanner.nextLine(); // consume newline
                    if (marks >= 0 && marks <= 100) break;
                    System.out.println("âš ï¸ Invalid input! Please enter between 0 and 100.");
                }
                totalMarks += marks;

                String subjectGrade = calculateGrade(marks);
                subjectDetails.append(String.format("%-15s %-10d %-10s\n", subject, marks, subjectGrade));
            }

            double percentage = (double) totalMarks / subjectNames.length;
            String overallGrade = calculateGrade(percentage);
            String feedback = generateFeedback(overallGrade, percentage);

            // Save data
            studentPercentages.put(studentName, percentage);
            overallGrades.put(studentName, overallGrade);

            // Print Formal Report Card
            System.out.println("\n=======================================");
            System.out.println("              ğŸ“‘ REPORT CARD");
            System.out.println("=======================================");
            System.out.println("ğŸ« Institution : ABC Senior Secondary School");
            System.out.println("ğŸ‘¤ Student Name: " + studentName);
            System.out.println("ğŸ†” Roll Number : " + rollNumber);
            System.out.println(subjectDetails);
            System.out.println("----------------------------------");
            System.out.println("ğŸ“Š Total Marks       : " + totalMarks + "/" + (subjectNames.length * 100));
            System.out.printf("ğŸ“Š Average Percentage: %.2f%%\n", percentage);
            System.out.println("ğŸ“Š Overall Grade     : " + overallGrade);
            System.out.println("ğŸ’¡ Feedback          : " + feedback);
            System.out.println("=======================================\n");

            System.out.print("Do you want to add another student? (yes/no): ");
            String choice = scanner.next();
            scanner.nextLine(); // consume newline
            addMoreStudents = !choice.equalsIgnoreCase("no");
        }

        // Show Scoreboard
        showScoreboard(studentPercentages);

        scanner.close();
    }

    // Calculate Grade
    private static String calculateGrade(double marks) {
        if (marks >= 90) return "A+";
        else if (marks >= 80) return "A";
        else if (marks >= 70) return "B";
        else if (marks >= 60) return "C";
        else if (marks >= 50) return "D";
        else return "F";
    }

    // Generate Feedback
    private static String generateFeedback(String grade, double percentage) {
        switch (grade) {
            case "A+": return "ğŸŒŸ Outstanding performance! Keep it up.";
            case "A": return "âœ¨ Excellent! You're doing great.";
            case "B": return (percentage >= 78) ? "ğŸ”¥ Almost an A! Keep pushing!" : "ğŸ‘ Good work, but thereâ€™s room for improvement.";
            case "C": return (percentage >= 68) ? "ğŸ“ˆ Close to B! Work a little harder." : "ğŸ™‚ Fair performance. Try to push harder.";
            case "D": return "âš ï¸ Needs improvement. Focus more.";
            default: return "âŒ Poor performance. Donâ€™t give up, keep practicing!";
        }
    }

    // Show Class Scoreboard
    private static void showScoreboard(Map<String, Double> studentPercentages) {
        System.out.println("\n=======================================");
        System.out.println("           ğŸ† CLASS SCOREBOARD ğŸ†");
        System.out.println("=======================================");

        List<Map.Entry<String, Double>> sortedList = new ArrayList<>(studentPercentages.entrySet());
        sortedList.sort((a, b) -> b.getValue().compareTo(a.getValue()));

        int rank = 1;
        for (Map.Entry<String, Double> entry : sortedList) {
            String rankStr = getRankString(rank);
            System.out.printf("%s %s : %.2f%%\n", rankStr, entry.getKey(), entry.getValue());
            rank++;
        }
        System.out.println("=======================================");
    }

    // Rank Helper
    private static String getRankString(int rank) {
        switch (rank) {
            case 1: return "ğŸ¥‡ 1st Place -";
            case 2: return "ğŸ¥ˆ 2nd Place -";
            case 3: return "ğŸ¥‰ 3rd Place -";
            default: return rank + "th Place -";
        }
    }
}
